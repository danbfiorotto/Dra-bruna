# üöÄ Migra√ß√£o para Sistema 100% Online com Supabase

## üìã Vis√£o Geral

Este documento detalha o plano completo para migrar o Sistema Dra. Bruna de um modelo h√≠brido (local + nuvem) para um sistema **100% online** usando Supabase como backend principal.

## üéØ Objetivos

- ‚úÖ Eliminar depend√™ncia de banco local SQLite
- ‚úÖ Centralizar todos os dados no Supabase
- ‚úÖ Simplificar arquitetura de sincroniza√ß√£o
- ‚úÖ Melhorar seguran√ßa e conformidade
- ‚úÖ Facilitar manuten√ß√£o e updates
- ‚úÖ Permitir acesso multi-dispositivo

---

## üìä An√°lise da Situa√ß√£o Atual

### üîç Estrutura Atual Identificada

#### **M√≥dulos de Sincroniza√ß√£o (Para Remo√ß√£o)**
- `hybrid_sync.rs` - Sistema h√≠brido complexo
- `hybrid_sync_simple.rs` - Vers√£o simplificada
- `auto_sync.rs` - Sincroniza√ß√£o autom√°tica
- `storage_sync.rs` - Sincroniza√ß√£o de arquivos
- `medical_records_sync.rs` - Sincroniza√ß√£o de prontu√°rios
- `tombstone_cleanup.rs` - Limpeza de registros deletados
- `sync_audit.rs` - Auditoria de sincroniza√ß√£o
- `offline_queue.rs` - Fila offline
- `entity_rules.rs` - Regras de entidades
- `merge_utils.rs` - Utilit√°rios de merge
- `deduplication.rs` - Deduplica√ß√£o
- `integrity_checks.rs` - Verifica√ß√µes de integridade
- `field_merge.rs` - Merge de campos
- `restore_window.rs` - Janela de restaura√ß√£o

#### **Banco de Dados Local (Para Remo√ß√£o)**
- `database.rs` - Interface SQLite
- `database_cipher.rs` - Vers√£o criptografada
- `commands_database.rs` - Comandos de banco local
- `dpapi.rs` - Prote√ß√£o de credenciais Windows
- `crypto.rs` - Criptografia local

#### **Estruturas de Dados Atuais**
```sql
-- Tabelas SQLite (para migra√ß√£o)
patients (id, name, email, phone, birth_date, address, notes, created_at, updated_at)
appointments (id, patient_id, date, time, status, notes, created_at, updated_at)
documents (id, patient_id, appointment_id, filename, file_type, file_size, encrypted, content_hash, created_at, updated_at)
document_content (document_id, encrypted_content, nonce, tag)
audit_logs (id, user_id, user_email, action, resource_type, resource_id, description, ip_address, user_agent, created_at)
sync_status (id, last_sync, sync_type, status, records_synced, created_at)
```

#### **Sistema de Autentica√ß√£o Atual**
- ‚úÖ Supabase Auth j√° implementado
- ‚úÖ RLS (Row Level Security) configurado
- ‚úÖ Sistema de perfis e roles
- ‚úÖ Permiss√µes granulares definidas

---

## üóÇÔ∏è TODO List - Migra√ß√£o Completa

### **FASE 1: Prepara√ß√£o e An√°lise** ‚è±Ô∏è 2-3 dias

#### 1.1 An√°lise de Dados Existentes
- [ ] **Auditoria de dados locais**
  - [ ] Exportar todos os dados do SQLite atual
  - [ ] Verificar integridade dos dados
  - [ ] Identificar depend√™ncias entre tabelas
  - [ ] Documentar mapeamento de campos

#### 1.2 Planejamento do Esquema Supabase
- [ ] **Design do novo esquema**
  - [ ] Criar diagrama ER completo
  - [ ] Definir pol√≠ticas RLS para cada tabela
  - [ ] Planejar √≠ndices e otimiza√ß√µes
  - [ ] Definir triggers e fun√ß√µes

#### 1.3 Backup e Seguran√ßa
- [ ] **Backup completo do sistema atual**
  - [ ] Backup do banco SQLite
  - [ ] Backup de todos os documentos
  - [ ] Backup de configura√ß√µes
  - [ ] Teste de restaura√ß√£o

### **FASE 2: Cria√ß√£o do Esquema Supabase** ‚è±Ô∏è 3-4 dias

#### 2.1 Tabelas Principais
- [ ] **Pacientes**
  ```sql
  CREATE TABLE patients (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name TEXT NOT NULL,
    email TEXT,
    phone TEXT,
    birth_date DATE,
    address TEXT,
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    created_by UUID REFERENCES auth.users(id),
    updated_by UUID REFERENCES auth.users(id)
  );
  ```

- [ ] **Agendamentos**
  ```sql
  CREATE TABLE appointments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    patient_id UUID REFERENCES patients(id) ON DELETE CASCADE,
    date DATE NOT NULL,
    time TIME NOT NULL,
    status TEXT NOT NULL CHECK (status IN ('scheduled', 'confirmed', 'completed', 'cancelled', 'no_show')),
    notes TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    created_by UUID REFERENCES auth.users(id),
    updated_by UUID REFERENCES auth.users(id)
  );
  ```

- [ ] **Documentos**
  ```sql
  CREATE TABLE documents (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    patient_id UUID REFERENCES patients(id) ON DELETE CASCADE,
    appointment_id UUID REFERENCES appointments(id) ON DELETE SET NULL,
    filename TEXT NOT NULL,
    file_type TEXT,
    file_size BIGINT,
    storage_path TEXT NOT NULL, -- Caminho no Supabase Storage
    content_hash TEXT,
    encrypted BOOLEAN DEFAULT true,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    created_by UUID REFERENCES auth.users(id),
    updated_by UUID REFERENCES auth.users(id)
  );
  ```

- [ ] **Prontu√°rios M√©dicos**
  ```sql
  CREATE TABLE medical_records (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    patient_id UUID REFERENCES patients(id) ON DELETE CASCADE,
    appointment_id UUID REFERENCES appointments(id) ON DELETE SET NULL,
    anamnesis TEXT,
    diagnosis TEXT,
    treatment_plan TEXT,
    notes TEXT,
    version INTEGER DEFAULT 1,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    created_by UUID REFERENCES auth.users(id),
    updated_by UUID REFERENCES auth.users(id)
  );
  ```

- [ ] **Financeiro**
  ```sql
  CREATE TABLE financial_transactions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    patient_id UUID REFERENCES patients(id) ON DELETE SET NULL,
    appointment_id UUID REFERENCES appointments(id) ON DELETE SET NULL,
    type TEXT NOT NULL CHECK (type IN ('income', 'expense')),
    category TEXT NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    description TEXT,
    transaction_date DATE NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    created_by UUID REFERENCES auth.users(id),
    updated_by UUID REFERENCES auth.users(id)
  );
  ```

- [ ] **Logs de Auditoria**
  ```sql
  CREATE TABLE audit_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES auth.users(id),
    user_email TEXT,
    action TEXT NOT NULL,
    resource_type TEXT NOT NULL,
    resource_id UUID,
    details JSONB,
    ip_address INET,
    user_agent TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
  );
  ```

#### 2.2 Pol√≠ticas RLS (Row Level Security)
- [ ] **Pol√≠ticas para cada tabela**
  - [ ] Pol√≠tica de leitura: usu√°rios autenticados podem ler
  - [ ] Pol√≠tica de escrita: apenas criador ou admin pode modificar
  - [ ] Pol√≠tica de dele√ß√£o: apenas admin pode deletar
  - [ ] Pol√≠tica de auditoria: todos podem ler logs

#### 2.3 √çndices e Otimiza√ß√µes
- [ ] **√çndices de performance**
  - [ ] √çndices em campos de busca frequente
  - [ ] √çndices compostos para queries complexas
  - [ ] √çndices parciais para dados ativos

#### 2.4 Triggers e Fun√ß√µes
- [ ] **Triggers autom√°ticos**
  - [ ] Atualiza√ß√£o de `updated_at`
  - [ ] Log de auditoria autom√°tico
  - [ ] Valida√ß√£o de dados
  - [ ] C√°lculos de campos derivados

### **FASE 3: Migra√ß√£o de Dados** ‚è±Ô∏è 2-3 dias

#### 3.1 Script de Migra√ß√£o
- [ ] **Script Python/Node.js para migra√ß√£o**
  - [ ] Conectar ao SQLite local
  - [ ] Conectar ao Supabase
  - [ ] Mapear e transformar dados
  - [ ] Migrar em lotes com rollback
  - [ ] Validar integridade p√≥s-migra√ß√£o

#### 3.2 Migra√ß√£o de Documentos
- [ ] **Upload para Supabase Storage**
  - [ ] Criar buckets organizados
  - [ ] Upload de todos os documentos
  - [ ] Manter estrutura de pastas
  - [ ] Atualizar refer√™ncias no banco

#### 3.3 Valida√ß√£o e Testes
- [ ] **Testes de integridade**
  - [ ] Contagem de registros
  - [ ] Verifica√ß√£o de relacionamentos
  - [ ] Teste de performance
  - [ ] Valida√ß√£o de permiss√µes

### **FASE 4: Refatora√ß√£o do Frontend** ‚è±Ô∏è 4-5 dias

#### 4.1 Remo√ß√£o de Depend√™ncias Locais
- [ ] **Arquivos para deletar**
  - [ ] `src-tauri/src/database.rs`
  - [ ] `src-tauri/src/database_cipher.rs`
  - [ ] `src-tauri/src/commands_database.rs`
  - [ ] `src-tauri/src/dpapi.rs`
  - [ ] `src-tauri/src/crypto.rs`
  - [ ] `src-tauri/src/auto_sync.rs`
  - [ ] `src-tauri/src/hybrid_sync.rs`
  - [ ] `src-tauri/src/hybrid_sync_simple.rs`
  - [ ] `src-tauri/src/storage_sync.rs`
  - [ ] `src-tauri/src/medical_records_sync.rs`
  - [ ] `src-tauri/src/tombstone_cleanup.rs`
  - [ ] `src-tauri/src/sync_audit.rs`
  - [ ] `src-tauri/src/offline_queue.rs`
  - [ ] `src-tauri/src/entity_rules.rs`
  - [ ] `src-tauri/src/merge_utils.rs`
  - [ ] `src-tauri/src/deduplication.rs`
  - [ ] `src-tauri/src/integrity_checks.rs`
  - [ ] `src-tauri/src/field_merge.rs`
  - [ ] `src-tauri/src/restore_window.rs`
  - [ ] `src-tauri/src/commands_sync.rs`

#### 4.2 Cria√ß√£o de Servi√ßos Supabase
- [ ] **Novos servi√ßos**
  - [ ] `src/services/supabase/patients.ts`
  - [ ] `src/services/supabase/appointments.ts`
  - [ ] `src/services/supabase/documents.ts`
  - [ ] `src/services/supabase/medicalRecords.ts`
  - [ ] `src/services/supabase/financial.ts`
  - [ ] `src/services/supabase/audit.ts`

#### 4.3 Atualiza√ß√£o de Hooks
- [ ] **Refatora√ß√£o de hooks**
  - [ ] `useAuth.ts` - Simplificar para apenas Supabase
  - [ ] `usePatients.ts` - Usar Supabase diretamente
  - [ ] `useAppointments.ts` - Usar Supabase diretamente
  - [ ] `useDocuments.ts` - Usar Supabase Storage
  - [ ] `useFinancial.ts` - Novo hook para financeiro
  - [ ] `useMedicalRecords.ts` - Novo hook para prontu√°rios

#### 4.4 Atualiza√ß√£o de Componentes
- [ ] **Componentes para atualizar**
  - [ ] `Patients.tsx` - Remover l√≥gica de cache local
  - [ ] `Appointments.tsx` - Usar Supabase em tempo real
  - [ ] `Documents.tsx` - Integrar com Supabase Storage
  - [ ] `Financial.tsx` - Implementar funcionalidades completas
  - [ ] `MedicalRecords.tsx` - Novo componente
  - [ ] `AuditLogs.tsx` - Atualizar para Supabase

### **FASE 5: Refatora√ß√£o do Backend Tauri** ‚è±Ô∏è 3-4 dias

#### 5.1 Simplifica√ß√£o do Backend
- [ ] **Manter apenas**
  - [ ] `auth.rs` - Autentica√ß√£o Supabase
  - [ ] `supabase.rs` - Cliente Supabase
  - [ ] `config.rs` - Configura√ß√µes
  - [ ] `main.rs` - Simplificado

#### 5.2 Remo√ß√£o de Comandos Tauri
- [ ] **Comandos para deletar**
  - [ ] Todos os comandos de `commands_database.rs`
  - [ ] Todos os comandos de `commands_sync.rs`
  - [ ] Comandos de criptografia local
  - [ ] Comandos de sincroniza√ß√£o

#### 5.3 Novos Comandos (se necess√°rio)
- [ ] **Comandos essenciais**
  - [ ] `get_auth_status` - Status de autentica√ß√£o
  - [ ] `logout` - Logout do sistema
  - [ ] `get_app_info` - Informa√ß√µes do app

### **FASE 6: Implementa√ß√£o de Funcionalidades Online** ‚è±Ô∏è 5-6 dias

#### 6.1 Sistema Financeiro Completo
- [ ] **Funcionalidades financeiras**
  - [ ] CRUD de transa√ß√µes
  - [ ] Categorias de receitas/despesas
  - [ ] Relat√≥rios financeiros
  - [ ] Dashboard financeiro
  - [ ] Exporta√ß√£o de relat√≥rios

#### 6.2 Sistema de Prontu√°rios
- [ ] **Prontu√°rios m√©dicos**
  - [ ] CRUD de prontu√°rios
  - [ ] Versionamento de prontu√°rios
  - [ ] Templates de prontu√°rios
  - [ ] Busca em prontu√°rios
  - [ ] Relat√≥rios m√©dicos

#### 6.3 Sistema de Documentos Avan√ßado
- [ ] **Gest√£o de documentos**
  - [ ] Upload para Supabase Storage
  - [ ] Organiza√ß√£o por pastas
  - [ ] Busca de documentos
  - [ ] Preview de documentos
  - [ ] Compartilhamento seguro

#### 6.4 Sistema de Relat√≥rios
- [ ] **Relat√≥rios diversos**
  - [ ] Relat√≥rio de pacientes
  - [ ] Relat√≥rio de agendamentos
  - [ ] Relat√≥rio financeiro
  - [ ] Relat√≥rio de auditoria
  - [ ] Exporta√ß√£o em PDF/CSV

### **FASE 7: Seguran√ßa e Conformidade** ‚è±Ô∏è 2-3 dias

#### 7.1 Pol√≠ticas de Seguran√ßa
- [ ] **Configura√ß√£o de RLS**
  - [ ] Pol√≠ticas por tabela
  - [ ] Pol√≠ticas por usu√°rio
  - [ ] Pol√≠ticas por role
  - [ ] Testes de seguran√ßa

#### 7.2 Auditoria e Logs
- [ ] **Sistema de auditoria**
  - [ ] Log autom√°tico de a√ß√µes
  - [ ] Rastreamento de mudan√ßas
  - [ ] Relat√≥rios de auditoria
  - [ ] Reten√ß√£o de logs

#### 7.3 Conformidade LGPD
- [ ] **Conformidade legal**
  - [ ] Pol√≠tica de privacidade
  - [ ] Termos de uso
  - [ ] Consentimento de dados
  - [ ] Direito ao esquecimento

### **FASE 8: Testes e Valida√ß√£o** ‚è±Ô∏è 3-4 dias

#### 8.1 Testes Funcionais
- [ ] **Testes de funcionalidades**
  - [ ] CRUD de todas as entidades
  - [ ] Autentica√ß√£o e autoriza√ß√£o
  - [ ] Upload/download de documentos
  - [ ] Gera√ß√£o de relat√≥rios
  - [ ] Performance e responsividade

#### 8.2 Testes de Seguran√ßa
- [ ] **Testes de seguran√ßa**
  - [ ] Teste de permiss√µes
  - [ ] Teste de RLS
  - [ ] Teste de auditoria
  - [ ] Teste de criptografia

#### 8.3 Testes de Performance
- [ ] **Testes de performance**
  - [ ] Tempo de carregamento
  - [ ] Tempo de resposta
  - [ ] Uso de mem√≥ria
  - [ ] Escalabilidade

### **FASE 9: Deploy e Migra√ß√£o** ‚è±Ô∏è 2-3 dias

#### 9.1 Prepara√ß√£o para Deploy
- [ ] **Configura√ß√£o de produ√ß√£o**
  - [ ] Vari√°veis de ambiente
  - [ ] Configura√ß√£o do Supabase
  - [ ] Configura√ß√£o de dom√≠nio
  - [ ] Certificados SSL

#### 9.2 Migra√ß√£o de Produ√ß√£o
- [ ] **Migra√ß√£o final**
  - [ ] Backup final do sistema atual
  - [ ] Migra√ß√£o de dados de produ√ß√£o
  - [ ] Valida√ß√£o em produ√ß√£o
  - [ ] Rollback plan

#### 9.3 Monitoramento
- [ ] **Monitoramento p√≥s-deploy**
  - [ ] Logs de aplica√ß√£o
  - [ ] M√©tricas de performance
  - [ ] Alertas de erro
  - [ ] Monitoramento de seguran√ßa

---

## üóÇÔ∏è Arquivos para Deletar

### **Backend Rust (Tauri)**
```
src-tauri/src/
‚îú‚îÄ‚îÄ database.rs                    ‚ùå DELETAR
‚îú‚îÄ‚îÄ database_cipher.rs             ‚ùå DELETAR
‚îú‚îÄ‚îÄ commands_database.rs           ‚ùå DELETAR
‚îú‚îÄ‚îÄ dpapi.rs                       ‚ùå DELETAR
‚îú‚îÄ‚îÄ crypto.rs                      ‚ùå DELETAR
‚îú‚îÄ‚îÄ auto_sync.rs                   ‚ùå DELETAR
‚îú‚îÄ‚îÄ hybrid_sync.rs                 ‚ùå DELETAR
‚îú‚îÄ‚îÄ hybrid_sync_simple.rs          ‚ùå DELETAR
‚îú‚îÄ‚îÄ storage_sync.rs                ‚ùå DELETAR
‚îú‚îÄ‚îÄ medical_records_sync.rs        ‚ùå DELETAR
‚îú‚îÄ‚îÄ tombstone_cleanup.rs           ‚ùå DELETAR
‚îú‚îÄ‚îÄ sync_audit.rs                  ‚ùå DELETAR
‚îú‚îÄ‚îÄ offline_queue.rs               ‚ùå DELETAR
‚îú‚îÄ‚îÄ entity_rules.rs                ‚ùå DELETAR
‚îú‚îÄ‚îÄ merge_utils.rs                 ‚ùå DELETAR
‚îú‚îÄ‚îÄ deduplication.rs               ‚ùå DELETAR
‚îú‚îÄ‚îÄ integrity_checks.rs            ‚ùå DELETAR
‚îú‚îÄ‚îÄ field_merge.rs                 ‚ùå DELETAR
‚îú‚îÄ‚îÄ restore_window.rs              ‚ùå DELETAR
‚îú‚îÄ‚îÄ commands_sync.rs               ‚ùå DELETAR
‚îî‚îÄ‚îÄ medical_record.rs              ‚ùå DELETAR (mover para frontend)
```

### **Frontend - Componentes para Refatorar**
```
src/
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts                 üîÑ REFATORAR
‚îÇ   ‚îú‚îÄ‚îÄ usePatients.ts             üîÑ REFATORAR
‚îÇ   ‚îú‚îÄ‚îÄ useAppointments.ts         üîÑ REFATORAR
‚îÇ   ‚îî‚îÄ‚îÄ useDocuments.ts            üîÑ REFATORAR
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ database.ts                ‚ùå DELETAR
‚îÇ   ‚îú‚îÄ‚îÄ sync.ts                    ‚ùå DELETAR
‚îÇ   ‚îî‚îÄ‚îÄ crypto.ts                  ‚ùå DELETAR
‚îî‚îÄ‚îÄ components/
    ‚îú‚îÄ‚îÄ Patients.tsx               üîÑ REFATORAR
    ‚îú‚îÄ‚îÄ Appointments.tsx           üîÑ REFATORAR
    ‚îú‚îÄ‚îÄ Documents.tsx              üîÑ REFATORAR
    ‚îî‚îÄ‚îÄ Financial.tsx              üîÑ REFATORAR
```

---

## üèóÔ∏è Nova Arquitetura

### **Estrutura Simplificada**
```
app-bruna/
‚îú‚îÄ‚îÄ src/                           # Frontend React
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ supabase/              # Servi√ßos Supabase
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ patients.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ appointments.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ documents.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ medicalRecords.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ financial.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ audit.ts
‚îÇ   ‚îú‚îÄ‚îÄ hooks/                     # Hooks React
‚îÇ   ‚îú‚îÄ‚îÄ components/                # Componentes UI
‚îÇ   ‚îî‚îÄ‚îÄ pages/                     # P√°ginas da aplica√ß√£o
‚îú‚îÄ‚îÄ src-tauri/src/                 # Backend Tauri (minimal)
‚îÇ   ‚îú‚îÄ‚îÄ auth.rs                    # Autentica√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ supabase.rs                # Cliente Supabase
‚îÇ   ‚îú‚îÄ‚îÄ config.rs                  # Configura√ß√µes
‚îÇ   ‚îî‚îÄ‚îÄ main.rs                    # Entry point
‚îî‚îÄ‚îÄ supabase/                      # Configura√ß√£o Supabase
    ‚îú‚îÄ‚îÄ migrations/                # Migra√ß√µes SQL
    ‚îú‚îÄ‚îÄ functions/                 # Edge Functions
    ‚îî‚îÄ‚îÄ seed.sql                   # Dados iniciais
```

---

## üîê Seguran√ßa e Permiss√µes

### **Sistema de Roles Atual**
- **Admin**: Acesso total ao sistema
- **User**: Acesso limitado (se implementado)

### **Pol√≠ticas RLS Propostas**
```sql
-- Exemplo para tabela patients
CREATE POLICY "Users can view patients" ON patients
  FOR SELECT USING (auth.role() = 'authenticated');

CREATE POLICY "Users can create patients" ON patients
  FOR INSERT WITH CHECK (auth.role() = 'authenticated');

CREATE POLICY "Users can update own patients" ON patients
  FOR UPDATE USING (auth.uid() = created_by);

CREATE POLICY "Only admins can delete patients" ON patients
  FOR DELETE USING (auth.jwt() ->> 'role' = 'admin');
```

### **Funcionalidades de Seguran√ßa**
- ‚úÖ Autentica√ß√£o via Supabase Auth
- ‚úÖ Autoriza√ß√£o via RLS
- ‚úÖ Auditoria completa de a√ß√µes
- ‚úÖ Criptografia de dados sens√≠veis
- ‚úÖ Backup autom√°tico
- ‚úÖ Conformidade LGPD

---

## üìà Benef√≠cios da Migra√ß√£o

### **T√©cnicos**
- ‚úÖ Arquitetura mais simples
- ‚úÖ Menos c√≥digo para manter
- ‚úÖ Melhor performance
- ‚úÖ Escalabilidade autom√°tica
- ‚úÖ Backup autom√°tico
- ‚úÖ Atualiza√ß√µes em tempo real

### **Operacionais**
- ‚úÖ Acesso multi-dispositivo
- ‚úÖ Sincroniza√ß√£o autom√°tica
- ‚úÖ Colabora√ß√£o em tempo real
- ‚úÖ Backup e recupera√ß√£o autom√°ticos
- ‚úÖ Monitoramento centralizado

### **Econ√¥micos**
- ‚úÖ Menor custo de manuten√ß√£o
- ‚úÖ Menor complexidade de deploy
- ‚úÖ Escalabilidade sob demanda
- ‚úÖ Redu√ß√£o de infraestrutura local

---

## ‚ö†Ô∏è Riscos e Mitiga√ß√µes

### **Riscos Identificados**
- ‚ùå **Depend√™ncia de internet**: Sistema n√£o funciona offline
- ‚ùå **Depend√™ncia do Supabase**: Vendor lock-in
- ‚ùå **Migra√ß√£o de dados**: Poss√≠vel perda de dados
- ‚ùå **Performance**: Lat√™ncia de rede

### **Mitiga√ß√µes**
- ‚úÖ **Cache local**: Implementar cache para dados frequentes
- ‚úÖ **Fallback**: Plano de conting√™ncia com backup local
- ‚úÖ **Backup completo**: M√∫ltiplos backups antes da migra√ß√£o
- ‚úÖ **CDN**: Usar CDN para melhor performance
- ‚úÖ **Testes extensivos**: Valida√ß√£o completa antes do deploy

---

## üìÖ Cronograma Estimado

| Fase | Dura√ß√£o | Depend√™ncias |
|------|---------|--------------|
| Fase 1: Prepara√ß√£o | 2-3 dias | - |
| Fase 2: Esquema Supabase | 3-4 dias | Fase 1 |
| Fase 3: Migra√ß√£o de Dados | 2-3 dias | Fase 2 |
| Fase 4: Refatora√ß√£o Frontend | 4-5 dias | Fase 3 |
| Fase 5: Refatora√ß√£o Backend | 3-4 dias | Fase 4 |
| Fase 6: Funcionalidades Online | 5-6 dias | Fase 5 |
| Fase 7: Seguran√ßa | 2-3 dias | Fase 6 |
| Fase 8: Testes | 3-4 dias | Fase 7 |
| Fase 9: Deploy | 2-3 dias | Fase 8 |
| **TOTAL** | **26-35 dias** | - |

---

## üöÄ Pr√≥ximos Passos

1. **Aprova√ß√£o do plano** - Revisar e aprovar este documento
2. **Setup do ambiente** - Configurar Supabase para desenvolvimento
3. **In√≠cio da Fase 1** - Come√ßar com an√°lise e prepara√ß√£o
4. **Comunica√ß√£o** - Informar stakeholders sobre a migra√ß√£o
5. **Backup completo** - Fazer backup de todo o sistema atual

---

## üìû Suporte e D√∫vidas

Para d√∫vidas sobre este plano de migra√ß√£o, consulte:
- Documenta√ß√£o do Supabase
- C√≥digo atual do sistema
- Este documento de migra√ß√£o
- Equipe de desenvolvimento

---

**Data de Cria√ß√£o**: 9 de Janeiro de 2025  
**Vers√£o**: 1.0  
**Status**: Aguardando Aprova√ß√£o
